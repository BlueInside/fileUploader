extends layout.pug

block content
  .container
    .row
      .col-12.mt-4
        if currentUser
          h1 Welcome back, #{currentUser.username}
        else 
          h1 Welcome to FileShare!
        p Share your files with others.

    .row.mt-4
      .col-md-6
        if currentUser
          h2 Upload a File

          // Upload form
          form(action="/upload" method="POST" enctype="multipart/form-data")
            .mb-3
              label(for="fileName" class="form-label") File Name
              input#fileName.form-control(type="text" name="fileName" required placeholder="Enter file name")
              
            .mb-3
              label(for="description" class="form-label") Description (optional)
              input#description.form-control(type="text" name="description" placeholder="Enter file description")

            .mb-3
              label(for="file" class="form-label") Choose File
              input#file.form-control(type="file" name="file" required)

            // Folder Selection
            if userFolders.length > 0
              .mb-3
                label(for="folderId" class="form-label") Select Folder
                select#folderId.form-control(name="folderId" required)
                  each folder in userFolders
                    option(value=folder.id) #{folder.name}
            else
              p.text-muted.mb-3 Please create a folder first to upload files.

            button.btn.btn-primary(type="submit") Upload File
        else
          h2 Start Sharing Your Files
          p To start uploading files, please 
          a(href="/register") create an account
          |  or 
          a(href="/login") log in

      .col-md-6
        h2 Recently Uploaded Files
        if recentFiles.length > 0
          ul.list-group
            each file in recentFiles
              li.list-group-item
                a(href=`/files/${file.id}`) #{file.fileName}
                p.text-muted Uploaded by: #{file.user.username} | Date: #{file.createdAt.toDateString()}
        else
          p.text-muted No files uploaded yet. Be the first to share!
